import React, { useEffect, useRef } from 'react';
import { useRouter } from 'next/router';
import { gsap } from 'gsap';
import { ScrollTrigger } from 'gsap/dist/ScrollTrigger';

gsap.registerPlugin(ScrollTrigger);

const BrandLogo = () => {
	const router = useRouter();
	const ref = useRef();

	useEffect(() => {
		const ctx = gsap.context(() => {
			const tl = gsap
				.timeline({
					defaults: {
						duration: 0.4,
						ease: 'power2.inOut',
					},
				})
				.to(ref.current.querySelectorAll('path:not([data-brand-initial])'), {
					autoAlpha: 0,
					stagger: -0.05,
				})
				.to(ref.current.querySelector('[data-brand-initial="Y"]'), {
					xPercent: -70,
				})
				.to(
					ref.current.querySelector('[data-brand-initial="C"]'),
					{
						xPercent: -200,
					},
					'<'
				);

			if (router.pathname === '/') {
				tl.pause();

				gsap.from(ref.current.querySelectorAll('path'), {
					autoAlpha: 0,
					yPercent: 50,
					delay: 0.4,
					duration: 0.6,
					ease: 'power2.out',
					stagger: 0.05,
					scrollTrigger: {
						trigger: ref.current,
						end: '100px top',
						onLeave: () => tl.play(),
						onEnterBack: () => tl.reverse(),
					},
				});
			}
		});

		return () => ctx.revert(); // cleanup
	}, [router]);

	return (
		<>
			<svg
				ref={ref}
				className="brand-logo"
				xmlns="http://www.w3.org/2000/svg"
				viewBox="0 0 1360 300"
				fill="var(--cr-white)"
			>
				<path
					data-brand-initial
					d="M68.011 192.316V110.121L0 3.9517H19.507L76.9737 95.1043H77.5009L135.495 3.9517H154.475L85.9363 110.648V192.316H68.011Z"
				/>
				<path d="M181.859 195.477C168.678 195.477 157.958 192.228 149.699 185.73C141.439 179.232 137.309 169.835 137.309 157.541C137.309 149.813 138.627 143.315 141.263 138.046C144.075 132.602 148.293 128.386 153.916 125.401C159.716 122.415 165.515 120.22 171.315 118.814C177.29 117.234 184.671 115.917 193.458 114.863C208.22 113.106 217.973 111.262 222.718 109.33C227.639 107.223 230.099 102.92 230.099 96.4215V93.787C230.099 75.5214 219.203 66.3886 197.412 66.3886C173.16 66.3886 160.419 76.4874 159.189 96.685H143.108C143.987 83.1614 148.996 72.5357 158.134 64.8079C167.273 57.0801 180.365 53.2163 197.412 53.2163C229.572 53.2163 245.652 67.2667 245.652 95.3677V169.396C245.652 176.948 248.64 180.9 254.615 181.251C255.494 181.251 257.514 180.9 260.678 180.198H261.469V192.053C258.305 193.458 254.615 194.16 250.397 194.16C237.744 194.16 231.066 187.75 230.363 174.929V172.031H229.572C218.5 187.662 202.596 195.477 181.859 195.477ZM184.759 182.305C198.818 182.305 209.889 178.353 217.973 170.45C226.233 162.371 230.363 153.238 230.363 143.052V118.551C223.685 122.239 211.91 125.225 195.039 127.508C189.416 128.211 184.934 128.913 181.595 129.616C178.432 130.318 174.829 131.372 170.787 132.777C166.921 134.182 163.934 135.851 161.825 137.783C159.892 139.715 158.134 142.349 156.552 145.686C155.147 149.023 154.444 152.975 154.444 157.541C154.444 174.051 164.549 182.305 184.759 182.305Z" />
				<path
					data-brand-initial="Y"
					d="M359.301 192.316V110.121L291.29 3.9517H310.797L368.263 95.1043H368.791L426.784 3.9517H445.764L377.226 110.648V192.316H359.301Z"
				/>
				<path d="M459.167 192.316V56.1142H475.511V192.316H459.167ZM459.167 27.135V3.9517H475.511V27.135H459.167Z" />
				<path d="M503.175 192.316V56.1142H519.519V76.9264H520.046C530.766 61.1196 545.968 53.2163 565.651 53.2163C578.655 53.2163 589.112 56.9923 597.02 64.5445C605.104 71.921 609.146 82.2832 609.146 95.6312V192.316H592.802V97.2118C592.802 77.1899 582.434 67.1789 561.696 67.1789C549.922 67.1789 539.905 70.8672 531.645 78.2437C523.561 85.6202 519.519 94.8408 519.519 105.906V192.316H503.175Z" />
				<path
					data-brand-initial="C"
					d="M753.802 195.741C727.792 195.741 707.143 186.784 691.854 168.869C676.564 150.955 668.92 127.42 668.92 98.2656C668.92 69.2865 676.652 45.6641 692.117 27.3985C707.582 9.13282 728.407 0 754.592 0C774.275 0 790.443 5.0933 803.096 15.2799C815.925 25.4665 823.921 39.4292 827.085 57.168H809.687C807.051 44.5225 800.9 34.4237 791.234 26.8716C781.568 19.1438 769.267 15.2799 754.329 15.2799C733.064 15.2799 716.545 23.0955 704.771 38.7267C693.172 54.1822 687.372 74.0285 687.372 98.2656C687.372 122.503 693.172 142.261 704.771 157.541C716.545 172.645 732.977 180.198 754.065 180.198C771.463 180.198 785.259 174.929 795.452 164.391C805.645 153.853 811.532 140.329 813.113 123.82H830.248C829.194 143.666 822.691 160.088 810.741 173.085C797.209 188.189 778.229 195.741 753.802 195.741Z"
				/>
				<path d="M852.327 192.316V3.9517H868.671V76.9264H869.198C879.918 61.1196 895.12 53.2163 914.802 53.2163C927.807 53.2163 938.264 56.9923 946.172 64.5445C954.256 71.921 958.298 82.2832 958.298 95.6312V192.316H941.954V97.2118C941.954 77.1899 931.586 67.1789 910.848 67.1789C899.074 67.1789 889.057 70.8672 880.797 78.2437C872.713 85.6202 868.671 94.8408 868.671 105.906V192.316H852.327Z" />
				<path d="M1021.53 195.477C1008.35 195.477 997.633 192.228 989.373 185.73C981.113 179.232 976.983 169.835 976.983 157.541C976.983 149.813 978.301 143.315 980.937 138.046C983.749 132.602 987.967 128.386 993.59 125.401C999.39 122.415 1005.19 120.22 1010.99 118.814C1016.96 117.234 1024.34 115.917 1033.13 114.863C1047.89 113.106 1057.65 111.262 1062.39 109.33C1067.31 107.223 1069.77 102.92 1069.77 96.4215V93.787C1069.77 75.5214 1058.88 66.3886 1037.09 66.3886C1012.83 66.3886 1000.09 76.4874 998.863 96.685H982.783C983.661 83.1614 988.67 72.5357 997.808 64.8079C1006.95 57.0801 1020.04 53.2163 1037.09 53.2163C1069.25 53.2163 1085.33 67.2667 1085.33 95.3677V169.396C1085.33 176.948 1088.31 180.9 1094.29 181.251C1095.17 181.251 1097.19 180.9 1100.35 180.198H1101.14V192.053C1097.98 193.458 1094.29 194.16 1090.07 194.16C1077.42 194.16 1070.74 187.75 1070.04 174.929V172.031H1069.25C1058.17 187.662 1042.27 195.477 1021.53 195.477ZM1024.43 182.305C1038.49 182.305 1049.56 178.353 1057.65 170.45C1065.91 162.371 1070.04 153.238 1070.04 143.052V118.551C1063.36 122.239 1051.58 125.225 1034.71 127.508C1029.09 128.211 1024.61 128.913 1021.27 129.616C1018.11 130.318 1014.5 131.372 1010.46 132.777C1006.6 134.182 1003.61 135.851 1001.5 137.783C999.566 139.715 997.808 142.349 996.227 145.686C994.821 149.023 994.118 152.975 994.118 157.541C994.118 174.051 1004.22 182.305 1024.43 182.305Z" />
				<path d="M1116.17 192.316V56.1142H1132.52V76.9264H1133.05C1143.77 61.1196 1158.97 53.2163 1178.65 53.2163C1191.65 53.2163 1202.11 56.9923 1210.02 64.5445C1218.1 71.921 1222.15 82.2832 1222.15 95.6312V192.316H1205.8V97.2118C1205.8 77.1899 1195.43 67.1789 1174.7 67.1789C1162.92 67.1789 1152.9 70.8672 1144.64 78.2437C1136.56 85.6202 1132.52 94.8408 1132.52 105.906V192.316H1116.17Z" />
				<path d="M1301.74 240C1285.57 240 1272.75 236.663 1263.26 229.989C1253.77 223.491 1248.41 214.973 1247.18 204.435H1262.99C1265.63 219.188 1278.37 226.564 1301.22 226.564C1315.45 226.564 1326.08 223.139 1333.11 216.29C1340.32 209.44 1343.92 199.868 1343.92 187.574V165.971H1343.13C1332.76 181.778 1318.35 189.682 1299.9 189.682C1282.15 189.682 1267.91 183.447 1257.19 170.977C1246.65 158.332 1241.38 141.91 1241.38 121.712C1241.38 100.461 1247 83.7761 1258.25 71.6575C1269.49 59.3633 1283.38 53.2163 1299.9 53.2163C1319.05 53.2163 1333.46 61.2075 1343.13 77.1899H1343.92V56.1142H1360V187.047C1360 202.151 1355.78 214.358 1347.35 223.666C1336.98 234.555 1321.78 240 1301.74 240ZM1300.69 175.982C1315.45 175.982 1326.52 171.153 1333.9 161.493C1341.28 151.658 1344.97 138.31 1344.97 121.449C1344.97 104.764 1341.2 91.5038 1333.64 81.6685C1326.26 71.8332 1315.36 66.9155 1300.95 66.9155C1287.6 66.9155 1277.14 71.921 1269.58 81.9319C1262.03 91.7673 1258.25 105.115 1258.25 121.976C1258.25 138.134 1261.85 151.218 1269.06 161.229C1276.26 171.065 1286.8 175.982 1300.69 175.982Z" />
			</svg>
			<style jsx>{`
				.brand-logo {
					display: block;
					width: 100%;
				}
			`}</style>
		</>
	);
};

export default BrandLogo;
